<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agent Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="dashboard">
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>🤖 Agents</h2>
        <button id="new-session-btn" class="secondary-btn">New Session</button>
      </div>

      <div class="agent-list">
        <div class="agent-status" data-agent="Finance Agent" onclick="selectAgent('Finance Agent')">
          <span class="status-dot ready"></span>
          <span>Finance Agent</span>
        </div>
        <div class="agent-status" data-agent="Research Agent" onclick="selectAgent('Research Agent')">
          <span class="status-dot ready"></span>
          <span>Research Agent</span>
        </div>
        <div class="agent-status" data-agent="Notes Agent" onclick="selectAgent('Notes Agent')">
          <span class="status-dot ready"></span>
          <span>Notes Agent</span>
        </div>
      </div>

      <!-- Navigation Menu -->
      <nav class="sidebar-nav">
        <a href="#dashboard" class="nav-item active" onclick="navigateToSection('dashboard', this)">
          <span class="nav-icon">📊</span>
          Dashboard
        </a>
        <a href="#agents" class="nav-item" onclick="navigateToSection('agents', this)">
          <span class="nav-icon">🤖</span>
          Agent Settings
        </a>
        <a href="#history" class="nav-item" onclick="navigateToSection('history', this)">
          <span class="nav-icon">📜</span>
          Task History
        </a>
        <a href="#costs" class="nav-item" onclick="navigateToSection('costs', this)">
          <span class="nav-icon">💰</span>
          API Usage
        </a>
        <a href="#settings" class="nav-item" onclick="navigateToSection('settings', this)">
          <span class="nav-icon">⚙️</span>
          Settings
        </a>
      </nav>

      <div class="sidebar-section">
        <h3>Activity</h3>
        <div id="agent-activity" class="activity-log"></div>
      </div>

      <div class="sidebar-section">
        <h3>Tools Used</h3>
        <div id="tool-usage" class="tool-log"></div>
      </div>
    </aside>

    <main class="main-content">
      <div class="chat-container">
        <div id="messages" class="chat-messages"></div>

        <div class="chat-input-container">
          <textarea
            id="user-input"
            placeholder="Ask a question or give a command..."
            rows="2"
          ></textarea>
          <button onclick="sendMessage()" class="primary-btn">Send</button>
        </div>
      </div>
    </main>
  </div>

  <!-- Markdown parser -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <!-- Streaming app logic -->
  <script src="app-streaming.js"></script>
  <script>
    // Wire up new session button
    document.getElementById('new-session-btn').addEventListener('click', newSession);

    // Wire up tools and activity tracking
    // These are called from app-streaming.js when events occur

    // Agent selection tracking
    let selectedAgent = null;

    // Agent selection function
    function selectAgent(agentName) {
      selectedAgent = agentName;

      // Remove active class from all agents
      document.querySelectorAll('.agent-status').forEach(el => {
        el.classList.remove('active');
      });

      // Add active class to selected agent
      const selectedEl = document.querySelector(`[data-agent="${agentName}"]`);
      if (selectedEl) {
        selectedEl.classList.add('active');
      }

      // Update activity log
      addAgentActivity(`Selected ${agentName}`);

      console.log(`🤖 Selected agent: ${agentName}`);
    }

    // Navigation function
    function navigateToSection(section, element) {
      event.preventDefault();

      // Remove active class from all nav items
      document.querySelectorAll('.nav-item').forEach(el => {
        el.classList.remove('active');
      });

      // Add active class to clicked item
      element.classList.add('active');

      // For now, just log the navigation (can be enhanced with actual routing)
      console.log(`📍 Navigating to: ${section}`);
      addAgentActivity(`Navigated to ${section}`);

      // TODO: Implement actual page switching logic here
      // This could involve showing/hiding different content sections
      // or implementing a proper router
    }
  </script>
</body>
</html>
